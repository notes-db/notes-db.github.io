import{V as p,S as h,E as f,s as k,R as D,D as u}from"./index.dd94ef6b.js";import"https://cdn.rawgit.com/JDMcKinstry/JavaScriptDateFormat/master/Date.format.min.js";const M=()=>({compare:t=>!1,destroy:()=>{},eq:t=>!1,estimatedHeight:-1,ignoreEvent:()=>!0,toDOM:()=>{const t=document.createElement("span");return t.innerHTML="&#x2022;",t.setAttribute("aria-hidden","true"),t},updateDOM:()=>!1}),x=t=>({compare:e=>e.isChecked===t,destroy:()=>{},eq:e=>e.isChecked===t,estimatedHeight:-1,ignoreEvent:()=>!1,isChecked:t,toDOM:()=>{const e=document.createElement("input");return e.setAttribute("aria-hidden","true"),e.className="ink-mde-task-toggle",e.type="checkbox",e.checked=t,e},updateDOM:()=>!1}),w=(t,e,r,i)=>Math.max(t,r)<=Math.min(e,i),m=(t,e,r)=>t.selection.ranges.some(i=>w(e,r,i.from,i.to)),E=(t,e)=>{const r=t.state.sliceDoc(e+2,e+5);return t.dispatch({changes:{from:e+2,to:e+5,insert:r==="[ ]"?"[x]":"[ ]"}}),!0},y=()=>{const t=()=>u.replace({widget:M()}),e=n=>u.replace({widget:x(n)}),r=n=>{const s=[];return k(n).iterate({enter:({type:o,from:c,to:a})=>{if(o.name==="ListMark"&&!m(n,c,a)){const d=n.sliceDoc(a+1,a+4);if(!["[ ]","[x]"].includes(d)){const g=n.sliceDoc(c,a);["-","*"].includes(g)&&s.push(t().range(c,a))}}if(o.name==="TaskMarker"&&!m(n,c-2,a)){const d=n.sliceDoc(c,a);s.push(e(d==="[x]").range(c-2,a))}}}),s.length>0?D.of(s):u.none},i=p.define(()=>({}),{eventHandlers:{mousedown:(n,s)=>{const o=n.target;if((o==null?void 0:o.nodeName)==="INPUT"&&o.classList.contains("ink-mde-task-toggle"))return E(s,s.posAtDOM(o))}}}),l=h.define({create(n){return r(n)},update(n,{state:s}){return r(s)},provide(n){return f.decorations.from(n)}});return[i,l]};export{y as lists};
