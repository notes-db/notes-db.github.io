"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const l=require("solid-js"),f=require("@codemirror/view"),de=require("@codemirror/autocomplete"),x=require("@codemirror/state"),Le=require("@replit/codemirror-vim"),V=require("@codemirror/language"),j=require("@codemirror/commands"),te=require("@codemirror/lang-markdown"),Me=require("@codemirror/language-data"),u=require("@lezer/highlight");function $e(e,n,t){let o=t.length,r=n.length,a=o,s=0,i=0,c=n[r-1].nextSibling,d=null;for(;s<r||i<a;){if(n[s]===t[i]){s++,i++;continue}for(;n[r-1]===t[a-1];)r--,a--;if(r===s){const g=a<o?i?t[i-1].nextSibling:t[a-i]:c;for(;i<a;)e.insertBefore(t[i++],g)}else if(a===i)for(;s<r;)(!d||!d.has(n[s]))&&n[s].remove(),s++;else if(n[s]===t[a-1]&&t[i]===n[r-1]){const g=n[--r].nextSibling;e.insertBefore(t[i++],n[s++].nextSibling),e.insertBefore(t[--a],g),n[r]=t[a]}else{if(!d){d=new Map;let b=i;for(;b<a;)d.set(t[b],b++)}const g=d.get(n[s]);if(g!=null)if(i<g&&g<a){let b=s,C=1,B;for(;++b<r&&b<a&&!((B=d.get(n[b]))==null||B!==g+C);)C++;if(C>g-i){const R=n[s];for(;i<g;)e.insertBefore(t[i++],R)}else e.replaceChild(t[i++],n[s++])}else s++;else n[s++].remove()}}}const ne="_$DX_DELEGATE";function Ee(e,n,t){let o;return l.createRoot(r=>{o=r,n===document?e():m(n,e(),n.firstChild?null:void 0,t)}),()=>{o(),n.textContent=""}}function k(e,n,t){const o=document.createElement("template");o.innerHTML=e;let r=o.content.firstChild;return t&&(r=r.firstChild),r}function ue(e,n=window.document){const t=n[ne]||(n[ne]=new Set);for(let o=0,r=e.length;o<r;o++){const a=e[o];t.has(a)||(t.add(a),n.addEventListener(a,_e))}}function oe(e,n,t){t==null?e.removeAttribute(n):e.setAttribute(n,t)}function m(e,n,t,o){if(t!==void 0&&!o&&(o=[]),typeof n!="function")return O(e,n,o,t);l.createRenderEffect(r=>O(e,n(),r,t),o)}function _e(e){const n=`$$${e.type}`;let t=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==t&&Object.defineProperty(e,"target",{configurable:!0,value:t}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),l.sharedConfig.registry&&!l.sharedConfig.done&&(l.sharedConfig.done=!0,document.querySelectorAll("[id^=pl-]").forEach(o=>o.remove()));t!==null;){const o=t[n];if(o&&!t.disabled){const r=t[`${n}Data`];if(r!==void 0?o.call(t,r,e):o.call(t,e),e.cancelBubble)return}t=t.host&&t.host!==t&&t.host instanceof Node?t.host:t.parentNode}}function O(e,n,t,o,r){for(l.sharedConfig.context&&!t&&(t=[...e.childNodes]);typeof t=="function";)t=t();if(n===t)return t;const a=typeof n,s=o!==void 0;if(e=s&&t[0]&&t[0].parentNode||e,a==="string"||a==="number"){if(l.sharedConfig.context)return t;if(a==="number"&&(n=n.toString()),s){let i=t[0];i&&i.nodeType===3?i.data=n:i=document.createTextNode(n),t=_(e,t,o,i)}else t!==""&&typeof t=="string"?t=e.firstChild.data=n:t=e.textContent=n}else if(n==null||a==="boolean"){if(l.sharedConfig.context)return t;t=_(e,t,o)}else{if(a==="function")return l.createRenderEffect(()=>{let i=n();for(;typeof i=="function";)i=i();t=O(e,i,t,o)}),()=>t;if(Array.isArray(n)){const i=[],c=t&&Array.isArray(t);if(P(i,n,t,r))return l.createRenderEffect(()=>t=O(e,i,t,o,!0)),()=>t;if(l.sharedConfig.context){for(let d=0;d<i.length;d++)if(i[d].parentNode)return t=i}if(i.length===0){if(t=_(e,t,o),s)return t}else c?t.length===0?re(e,i,o):$e(e,t,i):(t&&_(e),re(e,i));t=i}else if(n instanceof Node){if(l.sharedConfig.context&&n.parentNode)return t=s?[n]:n;if(Array.isArray(t)){if(s)return t=_(e,t,o,n);_(e,t,null,n)}else t==null||t===""||!e.firstChild?e.appendChild(n):e.replaceChild(n,e.firstChild);t=n}}return t}function P(e,n,t,o){let r=!1;for(let a=0,s=n.length;a<s;a++){let i=n[a],c=t&&t[a];if(i instanceof Node)e.push(i);else if(!(i==null||i===!0||i===!1))if(Array.isArray(i))r=P(e,i,c)||r;else if(typeof i=="function")if(o){for(;typeof i=="function";)i=i();r=P(e,Array.isArray(i)?i:[i],c)||r}else e.push(i),r=!0;else{const d=String(i);c&&c.nodeType===3&&c.data===d?e.push(c):e.push(document.createTextNode(d))}}return r}function re(e,n,t){for(let o=0,r=n.length;o<r;o++)e.insertBefore(n[o],t)}function _(e,n,t,o){if(t===void 0)return e.textContent="";const r=o||document.createTextNode("");if(n.length){let a=!1;for(let s=n.length-1;s>=0;s--){const i=n[s];if(r!==i){const c=i.parentNode===e;!a&&!s?c?e.replaceChild(r,i):e.insertBefore(r,t):c&&i.remove()}else a=!0}}else e.insertBefore(r,t);return[r]}const M={array:"[object Array]",object:"[object Object]",string:"[object String]",undefined:"[object Undefined]",window:"[object Window]"},Ae=e=>{if(Object.prototype.toString.call(e)===M.object)return`[object ${e.constructor.name}]`},A=(e,n)=>Ae(e)===n,De=(e,n)=>{const t=new WeakMap,o=(r,a)=>t.get(r)||(A(r,M.object)&&t.set(r,!0),A(a,M.undefined))?r:A(r,M.array)&&A(a,M.array)?[...a]:A(r,M.object)&&A(a,M.object)?Object.keys(r).reduce((s,i)=>(Object.hasOwn(a,i)?s[i]=o(r[i],a[i]):s[i]=r[i],s),{}):a;return o(e,n)},H=(e,n)=>De(e,n);var $=(e=>(e.Auto="auto",e.Dark="dark",e.Light="light",e))($||{}),S=(e=>(e.Appearance="appearance",e.Attribution="attribution",e.Autocomplete="autocomplete",e.Images="images",e.ReadOnly="readonly",e.Spellcheck="spellcheck",e.Vim="vim",e))(S||{}),h=(e=>(e.Bold="bold",e.Code="code",e.CodeBlock="code_block",e.Heading="heading",e.Image="image",e.Italic="italic",e.Link="link",e.List="list",e.OrderedList="ordered_list",e.Quote="quote",e.TaskList="task_list",e))(h||{}),T=(e=>(e.Completion="completion",e.Default="default",e.Grammar="grammar",e))(T||{});const ie=()=>document.createElement("div"),fe=()=>window.matchMedia("(prefers-color-scheme: dark)").matches,Be=e=>e===$.Dark?!0:e===$.Light?!1:fe(),q=e=>{const n=[{suffix:"border-radius",default:"0.25rem"},{suffix:"color",default:"currentColor"},{suffix:"flex-direction",default:"column"},{suffix:"font-family",default:"inherit"},{suffix:"block-background-color",default:"#121212",light:"#f5f5f5"},{suffix:"block-background-color-on-hover",default:"#0f0f0f",light:"#e0e0e0"},{suffix:"block-max-height",default:"20rem"},{suffix:"block-padding",default:"0.5rem"},{suffix:"code-background-color",default:"var(--ink-internal-block-background-color)"},{suffix:"code-color",default:"inherit"},{suffix:"code-font-family",default:"'Monaco', Courier, monospace"},{suffix:"editor-font-size",default:"1em"},{suffix:"editor-line-height",default:"2em"},{suffix:"editor-padding",default:"0.5rem"},{suffix:"inline-padding",default:"0.125rem"},{suffix:"modal-position",default:"fixed"},{suffix:"syntax-atom-color",default:"#d19a66"},{suffix:"syntax-comment-color",default:"#abb2bf"},{suffix:"syntax-comment-font-style",default:"italic"},{suffix:"syntax-emphasis-color",default:"inherit"},{suffix:"syntax-emphasis-font-style",default:"italic"},{suffix:"syntax-hashtag-background-color",default:"#222",light:"#eee"},{suffix:"syntax-hashtag-color",default:"inherit"},{suffix:"syntax-heading-color",default:"inherit"},{suffix:"syntax-heading-font-weight",default:"600"},{suffix:"syntax-heading1-color",default:"var(--ink-internal-syntax-heading-color, inherit)"},{suffix:"syntax-heading1-font-size",default:"1.6em"},{suffix:"syntax-heading1-font-weight",default:"600"},{suffix:"syntax-heading2-color",default:"var(--ink-internal-syntax-heading-color, inherit)"},{suffix:"syntax-heading2-font-size",default:"1.5em"},{suffix:"syntax-heading2-font-weight",default:"600"},{suffix:"syntax-heading3-color",default:"var(--ink-internal-syntax-heading-color, inherit)"},{suffix:"syntax-heading3-font-size",default:"1.4em"},{suffix:"syntax-heading3-font-weight",default:"600"},{suffix:"syntax-heading4-color",default:"var(--ink-internal-syntax-heading-color, inherit)"},{suffix:"syntax-heading4-font-size",default:"1.3em"},{suffix:"syntax-heading4-font-weight",default:"600"},{suffix:"syntax-heading5-color",default:"var(--ink-internal-syntax-heading-color, inherit)"},{suffix:"syntax-heading5-font-size",default:"1.2em"},{suffix:"syntax-heading5-font-weight",default:"600"},{suffix:"syntax-heading6-color",default:"var(--ink-internal-syntax-heading-color, inherit)"},{suffix:"syntax-heading6-font-size",default:"1.1em"},{suffix:"syntax-heading6-font-weight",default:"600"},{suffix:"syntax-highlight-background-color",default:"#555555"},{suffix:"syntax-keyword-color",default:"#c678dd"},{suffix:"syntax-link-color",default:"inherit"},{suffix:"syntax-meta-color",default:"#abb2bf"},{suffix:"syntax-monospace-color",default:"var(--ink-internal-code-color)"},{suffix:"syntax-monospace-font-family",default:"var(--ink-internal-code-font-family)"},{suffix:"syntax-name-color",default:"#d19a66"},{suffix:"syntax-name-label-color",default:"#abb2bf"},{suffix:"syntax-name-property-color",default:"#96c0d8"},{suffix:"syntax-name-property-definition-color",default:"#e06c75"},{suffix:"syntax-name-variable-color",default:"#e06c75"},{suffix:"syntax-name-variable-definition-color",default:"#e5c07b"},{suffix:"syntax-name-variable-local-color",default:"#d19a66"},{suffix:"syntax-name-variable-special-color",default:"inherit"},{suffix:"syntax-number-color",default:"#d19a66"},{suffix:"syntax-operator-color",default:"#96c0d8"},{suffix:"syntax-processing-instruction-color",default:"#444444",light:"#bbbbbb"},{suffix:"syntax-punctuation-color",default:"#abb2bf"},{suffix:"syntax-strikethrough-color",default:"inherit"},{suffix:"syntax-strikethrough-text-decoration",default:"line-through"},{suffix:"syntax-string-color",default:"#98c379"},{suffix:"syntax-string-special-color",default:"inherit"},{suffix:"syntax-strong-color",default:"inherit"},{suffix:"syntax-strong-font-weight",default:"600"},{suffix:"syntax-url-color",default:"#aaaaaa",light:"#666666"}],t=!Be(e.options.interface.appearance);return n.map(o=>{const r=t&&o.light?o.light:o.default;return`--ink-internal-${o.suffix}: var(--ink-${o.suffix}, ${r});`})},ae=()=>[f.EditorView.theme({},{dark:!0})],se=()=>[f.EditorView.theme({},{dark:!1})];class Ne extends f.WidgetType{constructor(){super()}eq(){return!0}toDOM(){const n=document.createElement("div"),t=n.appendChild(document.createElement("span")),o=n.appendChild(document.createElement("a"));return n.setAttribute("aria-hidden","true"),n.style.bottom="0",n.style.fontSize="0.75em",n.style.opacity="0.5",n.style.position="absolute",n.style.right="0",t.innerText="powered by ",o.href="https://github.com/voracious/ink-mde",o.innerText="ink-mde",o.rel="noopener noreferrer",o.target="_blank",o.style.color="var(--ink-internal-color)",o.style.fontWeight="600",o.style.textDecoration="none",n}}const Te=f.EditorView.baseTheme({".cm-content":{paddingBottom:"2em"}}),Ve=x.StateField.define({create(e){return x.RangeSet.of(le().range(e.doc.length))},update(e,n){return x.RangeSet.of(le().range(n.newDoc.length))},provide(e){return f.EditorView.decorations.from(e)}}),le=()=>f.Decoration.widget({widget:new Ne,side:1,block:!0}),je=()=>[Te,Ve];class He extends f.WidgetType{url;constructor({url:n}){super(),this.url=n}eq(n){return n.url===this.url}toDOM(){const n=document.createElement("div"),t=n.appendChild(document.createElement("div")),o=t.appendChild(document.createElement("figure")),r=o.appendChild(document.createElement("img"));return n.setAttribute("aria-hidden","true"),n.className="cm-image-container",t.className="cm-image-backdrop",o.className="cm-image-figure",r.className="cm-image-img",r.src=this.url,n.style.paddingBottom="0.5rem",n.style.paddingTop="0.5rem",t.classList.add("cm-image-backdrop"),t.style.borderRadius="var(--ink-internal-border-radius)",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.overflow="hidden",t.style.maxWidth="100%",o.style.margin="0",r.style.display="block",r.style.maxHeight="var(--ink-internal-block-max-height)",r.style.maxWidth="100%",r.style.width="100%",n}}const ze=()=>{const e=/!\[.*?\]\((?<url>.*?)\)/,n=a=>f.Decoration.widget({widget:new He(a),side:-1,block:!0}),t=a=>{const s=[];return V.syntaxTree(a).iterate({enter:({type:i,from:c,to:d})=>{if(i.name==="Image"){const g=e.exec(a.doc.sliceString(c,d));g&&g.groups&&g.groups.url&&s.push(n({url:g.groups.url}).range(a.doc.lineAt(c).from))}}}),s.length>0?x.RangeSet.of(s):f.Decoration.none},o=f.EditorView.baseTheme({".cm-image-backdrop":{backgroundColor:"var(--ink-internal-block-background-color)"}}),r=x.StateField.define({create(a){return t(a)},update(a,s){return s.docChanged?t(s.state):a.map(s.changes)},provide(a){return f.EditorView.decorations.from(a)}});return[o,r]},Re=()=>f.EditorView.contentAttributes.of({spellcheck:"true"}),Oe=(e,n)=>{const t=e.resolver(n);return e.compartment.of(t)},Ie=e=>e.extensions.map(n=>Oe(n,e.options)),We=(e,n)=>{const t=e.resolver(n);return e.compartment.reconfigure(t)},ge=e=>e.extensions.map(n=>We(n,e.options)),L=e=>{const n=new x.Compartment,t=qe[e];return{compartment:n,name:e,resolver:t}},Fe=()=>[L(S.Appearance),L(S.Attribution),L(S.Autocomplete),L(S.Images),L(S.ReadOnly),L(S.Spellcheck),L(S.Vim)],qe={appearance({interface:{appearance:e}}){return e===$.Dark?ae():e===$.Light?se():fe()?ae():se()},attribution(e){return e.interface.attribution?je():[]},autocomplete(e){return e.interface.autocomplete?de.closeBrackets():[]},images(e){return e.interface.images?ze():[]},readonly(e){return e.interface.readonly?x.EditorState.readOnly.of(!0):x.EditorState.readOnly.of(!1)},spellcheck(e){return e.interface.spellcheck?Re():[]},vim(e){return e.vim?Le.vim():[]}},pe=()=>({editor:new f.EditorView,extensions:Fe(),options:{doc:"",files:{clipboard:!1,dragAndDrop:!1,handler:()=>{},injectMarkup:!0,types:["image/*"]},hooks:{afterUpdate:()=>{},beforeUpdate:()=>{}},interface:{appearance:$.Auto,attribution:!0,autocomplete:!1,images:!1,readonly:!1,spellcheck:!0,toolbar:!1},plugins:[],selections:[],toolbar:{bold:!0,code:!0,codeBlock:!0,heading:!0,image:!0,italic:!0,link:!0,list:!0,orderedList:!0,quote:!0,taskList:!0,upload:!1},vim:!1},root:ie(),target:ie()}),Pe=e=>H(pe(),e),Ue=e=>{const[n,t]=l.createSignal(Pe({options:e}));return[n,t]},me=e=>{const n=e.map(t=>x.SelectionRange.fromJSON({anchor:t.start,head:t.end}));return x.EditorSelection.create(n)},Xe=e=>e.ranges.map(t=>({end:t.anchor<t.head?t.head:t.anchor,start:t.head<t.anchor?t.head:t.anchor})),w=e=>({...{block:!1,line:!1,multiline:!1,nodes:[],prefix:"",prefixStates:[],suffix:""},...e}),Qe={[h.Bold]:w({nodes:["StrongEmphasis"],prefix:"**",suffix:"**"}),[h.Code]:w({nodes:["InlineCode"],prefix:"`",suffix:"`"}),[h.CodeBlock]:w({block:!0,nodes:["FencedCode"],prefix:"```\n",suffix:"\n```"}),[h.Heading]:w({multiline:!0,nodes:["ATXHeading1","ATXHeading2","ATXHeading3","ATXHeading4","ATXHeading5","ATXHeading6"],prefix:"# ",prefixStates:["# ","## ","### ","#### ","##### ","###### ",""]}),[h.Image]:w({nodes:["Image"],prefix:"![](",suffix:")"}),[h.Italic]:w({nodes:["Emphasis"],prefix:"*",suffix:"*"}),[h.Link]:w({nodes:["Link"],prefix:"[](",suffix:")"}),[h.OrderedList]:w({line:!0,multiline:!0,nodes:["OrderedList"],prefix:"1. "}),[h.Quote]:w({line:!0,multiline:!0,nodes:["Blockquote"],prefix:"> "}),[h.TaskList]:w({line:!0,multiline:!0,nodes:["BulletList"],prefix:"- [ ] "}),[h.List]:w({line:!0,multiline:!0,nodes:["BulletList"],prefix:"- "})},he=([e,n],t)=>{const{editor:o}=e(),r=o.lineBlockAt(t.start),a=o.lineBlockAt(t.end);return{start:r.from,end:a.to}},Ge=([e,n],t)=>{const{editor:o}=e();let r=t.start;const a=[];for(;r<=t.end;){const s=o.lineBlockAt(r),i=Math.max(r,s.from),c=Math.min(r,s.to);a.push({start:i,end:c}),r=s.to+1}return a},Ke=([e,n],t)=>{const{editor:o}=e(),r=o.state.wordAt(t.start)?.from||t.start,a=o.state.wordAt(t.end)?.to||t.end;return{start:r,end:a}},Ze=([e,n],t)=>t||I([e,n]).pop()||{start:0,end:0},ke=([e,n],t)=>{const{editor:o}=e();return o.state.sliceDoc(t.start,t.end)},X=([e,n],t,o)=>Je(e(),o).find(({type:a})=>t.nodes.includes(a.name)),Je=({editor:{state:e}},n)=>{const t=[];return V.syntaxTree(e).iterate({from:n.start,to:n.end,enter:({type:o,from:r,to:a})=>{t.push({type:o,from:r,to:a})}}),t},Q=([e,n],t,o)=>{const r=ke([e,n],o),a=t.prefix.length,s=t.suffix.length*-1||r.length,i=r.slice(a,s);D([e,n],i,o)},Ye=([e,n],t,o)=>{const r=he([e,n],o),a=X([e,n],t,r);if(a){const s=a.from,i=a.to;Q([e,n],t,{start:s,end:i})}else{const s=t.prefix,i=t.suffix;W([e,n],{before:s,after:i,selection:r})}},et=([e,n],t,o)=>{Ge([e,n],o).forEach(a=>{xe([e,n],t,a)})},xe=([e,n],t,o)=>{const r=he([e,n],o),a=X([e,n],t,r),s=t.prefixStates.length>0;if(a&&s)t.prefixStates.find((i,c)=>{const d=a.from,g=a.to,b=ke([e,n],{start:d,end:g}),C=b.startsWith(i);return C&&D([e,n],b.replace(new RegExp(`^${i}`),t.prefixStates[c+1]),{start:d,end:g}),C});else if(a){const i=a.from,c=a.to;Q([e,n],t,{start:i,end:c})}else{const i=t.prefix,c=t.suffix;W([e,n],{before:i,after:c,selection:r})}},tt=([e,n],t,o)=>{const r=X([e,n],t,o);if(r){const a=r.from,s=r.to;Q([e,n],t,{start:a,end:s})}else{const{start:a,end:s}=Ke([e,n],o),i=Array.isArray(t.prefix)?t.prefix[0]:t.prefix,c=t.suffix;W([e,n],{before:i,after:c,selection:{start:a,end:s}})}},nt=([e,n],t,o)=>{const r=Qe[t],a=Ze([e,n],o);r.block?Ye([e,n],r,a):r.multiline?et([e,n],r,a):r.line?xe([e,n],r,a):tt([e,n],r,a)},ot=f.EditorView.baseTheme({".cm-line":{fontFamily:"var(--ink-internal-font-family)"},".cm-line.cm-codeblock":{backgroundColor:"var(--ink-internal-block-background-color)",fontFamily:"var(--ink-internal-code-font-family)",padding:"0 var(--ink-internal-block-padding)"},".cm-line.cm-codeblock.cm-codeblock-open":{borderRadius:"var(--ink-internal-border-radius) var(--ink-internal-border-radius) 0 0",paddingTop:"var(--ink-internal-block-padding)"},".cm-line.cm-codeblock.cm-codeblock-close":{borderRadius:"0 0 var(--ink-internal-border-radius) var(--ink-internal-border-radius)",paddingBottom:"var(--ink-internal-block-padding)"},".cm-line .cm-code":{backgroundColor:"var(--ink-internal-block-background-color)",fontFamily:"var(--ink-internal-code-font-family)",padding:"var(--ink-internal-inline-padding) 0"},".cm-line .cm-code.cm-code-open":{borderRadius:"var(--ink-internal-border-radius) 0 0 var(--ink-internal-border-radius)",paddingLeft:"var(--ink-internal-inline-padding)"},".cm-line .cm-code.cm-code-close":{borderRadius:"0 var(--ink-internal-border-radius) var(--ink-internal-border-radius) 0",paddingRight:"var(--ink-internal-inline-padding)"}}),rt=["CodeBlock","FencedCode","HTMLBlock","CommentBlock"],it=f.Decoration.line({attributes:{class:"cm-codeblock"}}),at=f.Decoration.line({attributes:{class:"cm-codeblock-open"}}),st=f.Decoration.line({attributes:{class:"cm-codeblock-close"}}),lt=f.Decoration.mark({attributes:{class:"cm-code"}}),ct=f.Decoration.mark({attributes:{class:"cm-code cm-code-open"}}),dt=f.Decoration.mark({attributes:{class:"cm-code cm-code-close"}}),ut=f.ViewPlugin.define(e=>({update:()=>ft(e)}),{decorations:e=>e.update()}),ft=e=>{const n=new x.RangeSetBuilder,t=V.syntaxTree(e.state);for(const o of e.visibleRanges)for(let r=o.from;r<o.to;){const a=e.state.doc.lineAt(r);let s;t.iterate({enter({type:i,from:c,to:d}){if(i.name!=="Document")if(rt.includes(i.name)){n.add(a.from,a.from,it);const g=e.state.doc.lineAt(c),b=e.state.doc.lineAt(d);return g.number===a.number&&n.add(a.from,a.from,at),b.number===a.number&&n.add(a.from,a.from,st),!1}else i.name==="InlineCode"?s={from:c,to:d,innerFrom:c,innerTo:d}:i.name==="CodeMark"&&(c===s.from?(s.innerFrom=d,n.add(c,d,ct)):d===s.to&&(s.innerTo=c,n.add(s.innerFrom,s.innerTo,lt),n.add(c,d,dt)))},from:a.from,to:a.to}),r=a.to+1}return n.finish()},gt=()=>[ot,ut],pt=[{key:"Tab",run:({state:e,dispatch:n})=>e.selection.ranges.some(t=>!t.empty)?j.indentMore({state:e,dispatch:n}):(n(e.update(e.replaceSelection("  "),{scrollIntoView:!0,annotations:x.Transaction.userEvent.of("input")})),!0),shift:j.indentLess}],mt=()=>f.keymap.of([...pt,...j.defaultKeymap,...j.historyKeymap]),ht=()=>f.EditorView.lineWrapping,kt=()=>{const e=f.EditorView.baseTheme({"&":{},".cm-scroller":{lineHeight:"var(--ink-internal-editor-line-height)",fontFamily:"var(--ink-internal-font-family)",fontSize:"var(--ink-internal-editor-font-size)"},".cm-line":{padding:"0"}}),n=V.syntaxHighlighting(V.HighlightStyle.define([{tag:u.tags.atom,color:"var(--ink-internal-syntax-atom-color)"},{tag:u.tags.meta,color:"var(--ink-internal-syntax-meta-color)"},{tag:u.tags.emphasis,color:"var(--ink-internal-syntax-emphasis-color)",fontStyle:"var(--ink-internal-syntax-emphasis-font-style)"},{tag:u.tags.strong,color:"var(--ink-internal-syntax-strong-color)",fontWeight:"var(--ink-internal-syntax-strong-font-weight)"},{tag:u.tags.strikethrough,color:"var(--ink-internal-syntax-strikethrough-color)",textDecoration:"var(--ink-internal-syntax-strikethrough-text-decoration)"},{tag:u.tags.comment,color:"var(--ink-internal-syntax-comment-color)",fontStyle:"var(--ink-internal-syntax-comment-font-style)"},{tag:u.tags.monospace,color:"var(--ink-internal-syntax-code-color)",fontFamily:"var(--ink-internal-syntax-code-font-family)"},{tag:u.tags.name,color:"var(--ink-internal-syntax-name-color)"},{tag:u.tags.labelName,color:"var(--ink-internal-syntax-name-label-color)"},{tag:u.tags.propertyName,color:"var(--ink-internal-syntax-name-property-color)"},{tag:u.tags.definition(u.tags.propertyName),color:"var(--ink-internal-syntax-name-property-definition-color)"},{tag:u.tags.variableName,color:"var(--ink-internal-syntax-name-variable-color)"},{tag:u.tags.definition(u.tags.variableName),color:"var(--ink-internal-syntax-name-variable-definition-color)"},{tag:u.tags.local(u.tags.variableName),color:"var(--ink-internal-syntax-name-variable-local-color)"},{tag:u.tags.special(u.tags.variableName),color:"var(--ink-internal-syntax-name-variable-special-color)"},{tag:u.tags.heading,color:"var(--ink-internal-syntax-heading-color)",fontWeight:"var(--ink-internal-syntax-heading-font-weight)"},{tag:u.tags.heading1,color:"var(--ink-internal-syntax-heading1-color)",fontSize:"var(--ink-internal-syntax-heading1-font-size)",fontWeight:"var(--ink-internal-syntax-heading1-font-weight)"},{tag:u.tags.heading2,color:"var(--ink-internal-syntax-heading2-color)",fontSize:"var(--ink-internal-syntax-heading2-font-size)",fontWeight:"var(--ink-internal-syntax-heading2-font-weight)"},{tag:u.tags.heading3,color:"var(--ink-internal-syntax-heading3-color)",fontSize:"var(--ink-internal-syntax-heading3-font-size)",fontWeight:"var(--ink-internal-syntax-heading3-font-weight)"},{tag:u.tags.heading4,color:"var(--ink-internal-syntax-heading4-color)",fontSize:"var(--ink-internal-syntax-heading4-font-size)",fontWeight:"var(--ink-internal-syntax-heading4-font-weight)"},{tag:u.tags.heading5,color:"var(--ink-internal-syntax-heading5-color)",fontSize:"var(--ink-internal-syntax-heading5-font-size)",fontWeight:"var(--ink-internal-syntax-heading5-font-weight)"},{tag:u.tags.heading6,color:"var(--ink-internal-syntax-heading6-color)",fontSize:"var(--ink-internal-syntax-heading6-font-size)",fontWeight:"var(--ink-internal-syntax-heading6-font-weight)"},{tag:u.tags.keyword,color:"var(--ink-internal-syntax-keyword-color)"},{tag:u.tags.number,color:"var(--ink-internal-syntax-number-color)"},{tag:u.tags.operator,color:"var(--ink-internal-syntax-operator-color)"},{tag:u.tags.punctuation,color:"var(--ink-internal-syntax-punctuation-color)"},{tag:u.tags.link,color:"var(--ink-internal-syntax-link-color)"},{tag:u.tags.url,color:"var(--ink-internal-syntax-url-color)"},{tag:u.tags.string,color:"var(--ink-internal-syntax-string-color)"},{tag:u.tags.special(u.tags.string),color:"var(--ink-internal-syntax-string-special-color)"},{tag:u.tags.processingInstruction,color:"var(--ink-internal-syntax-processing-instruction-color)"}]));return[e,n]},xt=e=>{if(e.length>0)return me(e)},be=e=>{const n=e.options.plugins.flatMap(r=>r.type===T.Completion?r.value:[]),t=e.options.plugins.flatMap(r=>r.type===T.Default?r.value:[]),o=e.options.plugins.flatMap(r=>r.type===T.Grammar?r.value:[]);return x.EditorState.create({doc:e.options.doc,selection:xt(e.options.selections),extensions:[...Ie(e),de.autocompletion({defaultKeymap:!0,icons:!1,override:n,optionClass:()=>"ink-tooltip-option"}),gt(),j.history(),mt(),ht(),te.markdown({base:te.markdownLanguage,codeLanguages:Me.languages,extensions:o}),kt(),...t]})},bt=([e,n])=>{const{editor:t}=e();t.destroy()},vt=([e,n])=>{const{editor:t}=e();return t.state.sliceDoc()},U=([e,n])=>{const{editor:t}=e();t.hasFocus||t.focus()},yt=([e,n],t,o)=>nt([e,n],t,o),D=([e,n],t,o,r=!1)=>{const{editor:a}=e();let s=o?.start,i=o?.end||o?.start;if(typeof s>"u"){const d=I([e,n]).pop();s=d.start,i=d.end}const c={changes:{from:s,to:i,insert:t}};if(r){const d=s===i?s+t.length:s,g=s+t.length;Object.assign(c,{selection:{anchor:d,head:g}})}a.dispatch(a.state.update(c))},wt=([e,n],t)=>{n(H(e(),{options:{doc:t}})),e().editor.setState(be(e()))},Ct=e=>({destroy:bt.bind(void 0,e),doc:vt.bind(void 0,e),focus:U.bind(void 0,e),insert:D.bind(void 0,e),load:wt.bind(void 0,e),reconfigure:St.bind(void 0,e),select:ve.bind(void 0,e),selections:I.bind(void 0,e),update:Lt.bind(void 0,e),wrap:W.bind(void 0,e)}),St=([e,n],t)=>{const o=ge(n(H(e(),{options:t})));e().editor.dispatch({effects:o})},ve=([e,n],t)=>{const{editor:o}=e();o.dispatch(o.state.update({selection:me(t)}))},I=([e,n])=>{const{editor:t}=e();return Xe(t.state.selection)},Lt=([e,n],t)=>{const{editor:o}=e();o.dispatch(o.state.update({changes:{from:0,to:o.state.doc.length,insert:t}}))},W=([e,n],{after:t,before:o,selection:r})=>{const{editor:a}=e(),s=r||I([e,n]).pop()||{start:0,end:0},i=a.state.sliceDoc(s.start,s.end);D([e,n],`${o}${i}${t}`,s),ve([e,n],[{start:s.start+o.length,end:s.end+o.length}])},Mt=`.ink-drop-zone{align-items:center;background-color:#00000080;color:var(--ink-internal-color);display:flex;inset:0;justify-content:center;position:var(--ink-internal-modal-position);z-index:100}.ink-drop-zone:not(.visible){display:none}.ink-drop-zone-modal{background-color:var(--ink-internal-block-background-color);border-radius:var(--ink-internal-border-radius);box-sizing:border-box;height:100%;max-height:20rem;max-width:40rem;padding:1rem;position:relative;width:100%}.ink-drop-zone-hide{cursor:pointer;height:1.75rem;position:absolute;right:.25rem;top:.25rem;width:1.75rem}.ink-drop-zone-hide svg{background-color:var(--ink-internal-block-background-color)}.ink-drop-zone-droppable-area{align-items:center;border:.2rem dashed var(--ink-internal-color);border-radius:.125rem;box-sizing:border-box;display:flex;flex-direction:column;font-size:1.25em;gap:1rem;height:100%;justify-content:center;padding:1rem;text-align:center}.ink-drop-zone-file-preview{align-items:center;display:flex;flex-wrap:wrap;gap:.5rem;max-width:25.5rem}.ink-drop-zone-file-preview-image{border:.125rem solid #222;border-radius:.125rem;box-sizing:border-box;height:6rem;object-fit:cover;padding:.5rem;width:6rem}
`,$t=k("<style></style>"),Et=k("<span>uploading files...</span>"),_t=k('<div class="ink-drop-zone"><div class="ink-drop-zone-modal"><div class="ink-drop-zone-droppable-area"><div class="ink-drop-zone-file-preview"></div></div><div class="ink-drop-zone-hide"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div></div></div>'),At=k('<img class="ink-drop-zone-file-preview-image">'),Dt=k("<span>drop files here</span>"),Bt=()=>{const[e,n]=l.createSignal(0),[t,o]=l.createSignal([]),[r,a]=l.createSignal(!1),[s,i]=l.createSignal(!1),[c,d]=z(),g=()=>{i(!1)},b=p=>{if(c().options.files.dragAndDrop){p.preventDefault(),p.stopPropagation();const v=p.dataTransfer;v?.files?Z(v.files):(n(0),i(!1),o([]))}},C=p=>{c().options.files.dragAndDrop&&(p.preventDefault(),n(e()+1),i(!0))},B=p=>{c().options.files.dragAndDrop&&(p.preventDefault(),n(e()-1),e()===0&&i(!1))},R=p=>{c().options.files.dragAndDrop&&(p.preventDefault(),i(!0))},G=p=>{c().options.files.dragAndDrop&&(p.preventDefault(),n(0),i(!1))},K=p=>{if(c().options.files.clipboard){p.preventDefault();const v=p.clipboardData;v?.files&&v.files.length>0&&Z(v.files)}},Z=p=>{Array.from(p).forEach(v=>{o([...t(),v])}),a(!0),i(!0),Promise.resolve(c().options.files.handler(p)).then(v=>{if(c().options.files.injectMarkup&&v){const E=`![](${v})`;D([c,d],E)}}).finally(()=>{n(0),a(!1),i(!1),o([])})};return l.onMount(()=>{document.addEventListener("dragenter",C),document.addEventListener("dragleave",B),document.addEventListener("dragover",R),document.addEventListener("drop",G),c().root.addEventListener("paste",K)}),l.onCleanup(()=>{document.removeEventListener("dragenter",C),document.removeEventListener("dragleave",B),document.removeEventListener("dragover",R),document.removeEventListener("drop",G),c().root.removeEventListener("paste",K)}),[(()=>{const p=$t.cloneNode(!0);return m(p,Mt),p})(),(()=>{const p=_t.cloneNode(!0),v=p.firstChild,E=v.firstChild,Ce=E.firstChild,Se=E.nextSibling;return E.addEventListener("drop",b),m(Ce,l.createComponent(l.For,{get each(){return t().slice(0,8)},children:J=>(()=>{const F=At.cloneNode(!0);return l.createRenderEffect(N=>{const Y=J.name,ee=URL.createObjectURL(J);return Y!==N._v$&&oe(F,"alt",N._v$=Y),ee!==N._v$2&&oe(F,"src",N._v$2=ee),N},{_v$:void 0,_v$2:void 0}),F})()})),m(E,l.createComponent(l.Show,{get when(){return r()},get fallback(){return Dt.cloneNode(!0)},get children(){return Et.cloneNode(!0)}}),null),Se.$$click=g,l.createRenderEffect(()=>p.classList.toggle("visible",!!s())),p})()]};ue(["click"]);const Nt=e=>{const n=new f.EditorView({dispatch:t=>{const{options:o}=e;o.hooks.beforeUpdate(t.newDoc.toString()),n.update([t]),t.docChanged&&o.hooks.afterUpdate(t.newDoc.toString())},state:be(e)});return n},Tt=()=>{const[e,n]=z(),t=Nt(e());return n(H(e(),{editor:t})),t.dom},Vt=k('<button class="ink-button"></button>'),y=e=>(()=>{const n=Vt.cloneNode(!0);return n.$$click=t=>e.onclick(t),m(n,()=>e.children),n})();ue(["click"]);const jt=`.ink .ink-toolbar{background-color:var(--ink-internal-block-background-color);border-radius:var(--ink-internal-border-radius);bottom:.25rem;color:inherit;display:flex;gap:2rem;overflow:auto;padding:.25rem;position:sticky;top:.25rem;z-index:10}.ink .ink-toolbar-group{display:flex}.ink .ink-toolbar .ink-button{align-items:center;background:none;border:none;border-radius:var(--ink-internal-border-radius);color:inherit;cursor:pointer;display:flex;height:2.25rem;justify-content:center;padding:.4rem;width:2.25rem}.ink .ink-toolbar .ink-button:hover{background-color:var(--ink-internal-block-background-color-on-hover)}.ink .ink-toolbar .ink-button>*{align-items:center;display:flex;height:100%}
`,Ht=k('<svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-miterlimit="5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 4V10M6 16V10M6 10H14M14 10V4M14 10V16"></path></svg>'),zt=k('<svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-miterlimit="5" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 10H10.5C12.1569 10 13.5 11.3431 13.5 13C13.5 14.6569 12.1569 16 10.5 16H6.5V4H9.5C11.1569 4 12.5 5.34315 12.5 7C12.5 8.65686 11.1569 10 9.5 10"></path></svg>'),Rt=k('<svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-miterlimit="5" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4L9 16M13 4H9M7 16H11"></path></svg>'),Ot=k('<svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-miterlimit="5" stroke-linecap="round" stroke-linejoin="round"><path d="M2.00257 16H17.9955M2.00055 4H18M7 10H18.0659M2 8.5V11.4999C2.4 11.5 2.5 11.5 2.5 11.5V11V10.5M4 8.5V11.4999H4.5V11V10.5"></path></svg>'),It=k('<svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-miterlimit="5" stroke-linecap="round" stroke-linejoin="round"><path d="M13 4L7 16"></path><path d="M5 7L2 10L5 13"></path><path d="M15 7L18 10L15 13"></path></svg>'),Wt=k('<svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-miterlimit="5" stroke-linecap="round" stroke-linejoin="round"><path d="M7 4L8 6"></path></svg>'),Ft=k('<svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-miterlimit="5" stroke-linecap="round" stroke-linejoin="round"><path d="M7 16H17.8294"></path><path d="M2 16H4"></path><path d="M7 10H17.8294"></path><path d="M2 10H4"></path><path d="M7 4H17.8294"></path><path d="M2 4H4"></path></svg>'),qt=k('<svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-miterlimit="5" stroke-linecap="round" stroke-linejoin="round"><path d="M7 16H18"></path><path d="M2 17.0242C2.48314 17.7569 3.94052 17.6154 3.99486 16.7919C4.05315 15.9169 3.1975 16.0044 2.99496 16.0044M2.0023 14.9758C2.48544 14.2431 3.94282 14.3846 3.99716 15.2081C4.05545 16.0831 3.1998 16.0002 2.99726 16.0002"></path><path d="M7 10H18"></path><path d="M2.00501 11.5H4M2.00193 8.97562C2.48449 8.24319 3.9401 8.38467 3.99437 9.20777C4.05259 10.0825 2.04342 10.5788 2 11.4996"></path><path d="M7 4H18"></path><path d="M2 5.5H4M2.99713 5.49952V2.5L2.215 2.93501"></path></svg>'),Pt=k('<svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-miterlimit="5" stroke-linecap="round" stroke-linejoin="round"><path d="M7 16H17.8294"></path><path d="M5 15L3 17L2 16"></path><path d="M7 10H17.8294"></path><path d="M5 9L3 11L2 10"></path><path d="M7 4H17.8294"></path><path d="M5 3L3 5L2 4"></path></svg>'),Ut=k('<svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-miterlimit="5" stroke-linecap="round" stroke-linejoin="round"><path d="M9.12127 10.881C10.02 11.78 11.5237 11.7349 12.4771 10.7813L15.2546 8.00302C16.2079 7.04937 16.253 5.54521 15.3542 4.6462C14.4555 3.74719 12.9512 3.79174 11.9979 4.74539L10.3437 6.40007M10.8787 9.11903C9.97997 8.22002 8.47626 8.26509 7.52288 9.21874L4.74545 11.997C3.79208 12.9506 3.74701 14.4548 4.64577 15.3538C5.54452 16.2528 7.04876 16.2083 8.00213 15.2546L9.65633 13.5999"></path></svg>'),Xt=k('<svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-miterlimit="5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="4" width="16" height="12" rx="1"></rect><path d="M7.42659 7.67597L13.7751 13.8831M2.00208 12.9778L7.42844 7.67175"></path><path d="M11.9119 12.0599L14.484 9.54443L17.9973 12.9785"></path><path d="M10.9989 7.95832C11.551 7.95832 11.9986 7.52072 11.9986 6.98092C11.9986 6.44113 11.551 6.00354 10.9989 6.00354C10.4468 6.00354 9.99921 6.44113 9.99921 6.98092C9.99921 7.52072 10.4468 7.95832 10.9989 7.95832Z"></path></svg>'),Qt=k('<svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-miterlimit="5" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13V4M10 4L13 7M10 4L7 7"></path><path d="M2 13V15C2 15.5523 2.44772 16 3 16H17C17.5523 16 18 15.5523 18 15V13"></path></svg>'),Gt=k('<div class="ink-toolbar"><style></style><div class="ink-toolbar-group"></div><div class="ink-toolbar-group"></div><div class="ink-toolbar-group"></div><div class="ink-toolbar-group"></div></div>'),Kt=()=>{const[e,n]=z(),t=a=>{yt([e,n],a),U([e,n])},o=document.createElement("input"),r=()=>{o.click()};return o.style.display="none",o.type="file",o.onchange=a=>{const s=a.target;s?.files&&Promise.resolve(e().options.files.handler(s.files)).then(i=>{const c=`![](${i})`;D([e,n],c),U([e,n])})},(()=>{const a=Gt.cloneNode(!0),s=a.firstChild,i=s.nextSibling,c=i.nextSibling,d=c.nextSibling,g=d.nextSibling;return m(s,jt),m(i,l.createComponent(l.Show,{get when(){return e().options.toolbar.heading},get children(){return l.createComponent(y,{onclick:()=>t(h.Heading),get children(){return Ht.cloneNode(!0)}})}}),null),m(i,l.createComponent(l.Show,{get when(){return e().options.toolbar.bold},get children(){return l.createComponent(y,{onclick:()=>t(h.Bold),get children(){return zt.cloneNode(!0)}})}}),null),m(i,l.createComponent(l.Show,{get when(){return e().options.toolbar.italic},get children(){return l.createComponent(y,{onclick:()=>t(h.Italic),get children(){return Rt.cloneNode(!0)}})}}),null),m(c,l.createComponent(l.Show,{get when(){return e().options.toolbar.quote},get children(){return l.createComponent(y,{onclick:()=>t(h.Quote),get children(){return Ot.cloneNode(!0)}})}}),null),m(c,l.createComponent(l.Show,{get when(){return e().options.toolbar.codeBlock},get children(){return l.createComponent(y,{onclick:()=>t(h.CodeBlock),get children(){return It.cloneNode(!0)}})}}),null),m(c,l.createComponent(l.Show,{get when(){return e().options.toolbar.code},get children(){return l.createComponent(y,{onclick:()=>t(h.Code),get children(){return Wt.cloneNode(!0)}})}}),null),m(d,l.createComponent(l.Show,{get when(){return e().options.toolbar.list},get children(){return l.createComponent(y,{onclick:()=>t(h.List),get children(){return Ft.cloneNode(!0)}})}}),null),m(d,l.createComponent(l.Show,{get when(){return e().options.toolbar.orderedList},get children(){return l.createComponent(y,{onclick:()=>t(h.OrderedList),get children(){return qt.cloneNode(!0)}})}}),null),m(d,l.createComponent(l.Show,{get when(){return e().options.toolbar.taskList},get children(){return l.createComponent(y,{onclick:()=>t(h.TaskList),get children(){return Pt.cloneNode(!0)}})}}),null),m(g,l.createComponent(l.Show,{get when(){return e().options.toolbar.link},get children(){return l.createComponent(y,{onclick:()=>t(h.Link),get children(){return Ut.cloneNode(!0)}})}}),null),m(g,l.createComponent(l.Show,{get when(){return e().options.toolbar.image},get children(){return l.createComponent(y,{onclick:()=>t(h.Image),get children(){return Xt.cloneNode(!0)}})}}),null),m(g,l.createComponent(l.Show,{get when(){return e().options.toolbar.upload},get children(){return l.createComponent(y,{onclick:r,get children(){return[Qt.cloneNode(!0),o]}})}}),null),a})()},Zt=`.ink{color:var(--ink-internal-color, inherit);display:flex;flex-direction:var(--ink-internal-flex-direction, column);gap:1rem;padding:var(--ink-internal-editor-padding, 0)}.ink .cm-tooltip{background-color:var(--ink-internal-block-background-color);border-radius:var(--ink-internal-border-radius);font-family:inherit;padding:.25rem}.ink .cm-tooltip.cm-tooltip-autocomplete ul{font-family:inherit}.ink .cm-tooltip.cm-tooltip-autocomplete ul li.ink-tooltip-option{border-radius:var(--ink-internal-border-radius);padding:.25rem}.ink .cm-tooltip.cm-tooltip-autocomplete ul li.ink-tooltip-option[aria-selected]{background-color:#96969640}.ink .cm-completionLabel{font-family:inherit}
`,Jt=k("<style></style>"),Yt=()=>{const[e]=z(),[n,t]=l.createSignal(q(e()));return l.createEffect(()=>{t(q(e()))}),l.onMount(()=>{const o=window.matchMedia("(prefers-color-scheme: dark)"),r=a=>{const{editor:s,root:i}=e();if(i.isConnected){const c=ge(e());s.dispatch({effects:c}),t(q(e()))}else o.removeEventListener("change",r)};o.addEventListener("change",r)}),(()=>{const o=Jt.cloneNode(!0);return m(o,()=>`.ink {
  ${n().join(`
  `)}
}`,null),m(o,Zt,null),o})()},en=k('<div class="ink"></div>'),tn=()=>{const[e,n]=z(),t=o=>{n(H(e(),{root:o}))};return(()=>{const o=en.cloneNode(!0);return t(o),m(o,l.createComponent(Yt,{}),null),m(o,l.createComponent(Bt,{}),null),m(o,l.createComponent(l.Show,{get when(){return e().options.interface.toolbar},get children(){return l.createComponent(Kt,{})}}),null),m(o,l.createComponent(Tt,{}),null),o})()},ce=pe(),ye=l.createContext([()=>ce,e=>typeof e=="function"?e(ce):e]),nn=e=>l.createComponent(ye.Provider,{get value(){return e.store},get children(){return e.children}}),z=()=>l.useContext(ye),on=e=>l.createComponent(nn,{get store(){return e.store},get children(){return l.createComponent(tn,{get store(){return e.store}})}}),rn=({theme:e,decorator:n})=>{const t=f.EditorView.baseTheme(e),o=s=>f.Decoration.widget({widget:s,side:-1,block:!0}),r=s=>{const c=n(s).map(d=>o(d.widget).range(d.from,d.to));return c.length>0?x.RangeSet.of(c):f.Decoration.none},a=x.StateField.define({create(s){return r(s)},update(s,i){return i.docChanged?r(i.state):s.map(i.changes)},provide(s){return f.EditorView.decorations.from(s)}});return[t,a]},an=e=>e,we=(e,n={})=>{const t=Ue(n);return Ee(()=>l.createComponent(on,{store:t}),e),Ct(t)};exports.Appearance=$;exports.Extensions=S;exports.Markup=h;exports.PluginType=T;exports.default=we;exports.defineOptions=an;exports.extension=rn;exports.ink=we;
